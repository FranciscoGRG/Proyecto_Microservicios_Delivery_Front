<div class="container mx-auto px-4 sm:px-6 lg:px-8 py-8">
  <h1 class="text-3xl font-bold leading-tight text-gray-900 mb-6">‚öôÔ∏è Panel de Administraci√≥n</h1>

  <div class="border-b border-gray-200">
    <nav class="-mb-px flex space-x-8" aria-label="Tabs">
      <button
        (click)="setActiveTab('products')"
        [ngClass]="{
          'border-indigo-500 text-indigo-600': actibeTab === 'products',
          'border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700':
            actibeTab !== 'products'
        }"
        class="whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium focus:outline-none transition duration-150 ease-in-out"
      >
        Gesti√≥n de Productos
      </button>

      <button
        (click)="setActiveTab('orders')"
        [ngClass]="{
          'border-indigo-500 text-indigo-600': actibeTab === 'orders',
          'border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700':
            actibeTab !== 'orders'
        }"
        class="whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium focus:outline-none transition duration-150 ease-in-out"
      >
        Gesti√≥n de √ìrdenes
      </button>
    </nav>
  </div>

  <div class="mt-8">
    @if(actibeTab === 'products'){
    <section>
      <h2 class="text-2xl font-semibold text-gray-800 mb-4">üõí Productos</h2>

      <div class="mb-6">
        <button
          class="px-4 py-2 bg-indigo-600 text-white rounded-md shadow hover:bg-indigo-700 transition"
          routerLink="/admin/products/new"
        >
          + Crear Nuevo Producto
        </button>
      </div>

      <div class="bg-white shadow overflow-hidden sm:rounded-lg">
        <table class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <th
                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
              >
                Nombre
              </th>
              <th
                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
              >
                Precio
              </th>
              <th
                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
              >
                Acciones
              </th>
            </tr>
          </thead>
          <tbody class="bg-white divide-y divide-gray-200">
            @if (products().length > 0) {} @for (product of products(); track product.id) {
            <tr>
              <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                {{ product.name }}
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                {{ product.price | currency : 'USD' : 'symbol' : '1.0-2' }}
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 space-x-3">
                <button
                  [routerLink]="['/admin/products/edit', product.id]"
                  class="text-indigo-600 hover:text-indigo-900"
                >
                  Editar
                </button>
                <button
                  class="text-red-600 hover:text-red-900"
                  (click)="onDeleteProduct(product.id)"
                >
                  Eliminar
                </button>
              </td>
            </tr>
            }
          </tbody>
        </table>
      </div>
    </section>
    } @if (actibeTab === 'orders') {
    <section>
      <h2 class="text-3xl font-semibold text-gray-800 mb-6">üì¶ √ìrdenes</h2>

      <div class="space-y-6">
        @for (order of orders(); track order.id) {
        <div
          class="relative rounded-2xl overflow-hidden shadow-md hover:shadow-lg transition-shadow border-l-4"
          [ngClass]="{
            'border-green-500 bg-green-50/40': order.status === 'COMPLETED',
            'border-yellow-500 bg-yellow-50/40': order.status === 'PAYMENT_INTENT_CREATED',
            'border-red-500 bg-red-50/40': order.status === 'CANCELLED'
          }"
        >
          <div
            class="flex flex-wrap justify-between items-center px-6 py-4 bg-white/70 backdrop-blur-sm"
          >
            <div>
              <p class="text-sm text-gray-500">ID Orden</p>
              <h3 class="text-lg font-bold text-gray-800">ORD-{{ order.id }}</h3>
            </div>

            <div>
              <p class="text-sm text-gray-500">Cliente</p>
              <p class="text-gray-700 font-medium">{{ order.userEmail }}</p>
            </div>

            <div>
              <p class="text-sm text-gray-500">Total</p>
              <p class="text-xl font-semibold text-gray-800">
                {{ order.totalPrice | currency : 'USD' : 'symbol' : '1.2-2' }}
              </p>
            </div>

            <div>
              <p class="text-sm text-gray-500">Estado</p>
              <span
                class="inline-block px-3 py-1 text-sm font-semibold rounded-full"
                [ngClass]="{
                  'bg-green-100 text-green-700': order.status === 'COMPLETED',
                  'bg-yellow-100 text-yellow-700': order.status === 'PAYMENT_INTENT_CREATED',
                  'bg-red-100 text-red-700': order.status === 'CANCELLED'
                }"
              >
                {{ order.status }}
              </span>
            </div>

            <div>
              <p class="text-sm text-gray-500">Fecha</p>
              <p class="text-gray-700">{{ order.createdAt | date : 'short' }}</p>
            </div>

            <div class="flex items-center space-x-3">
              <button (click)="onDeleteOrder(order.id)" class="text-red-600 hover:text-red-800 text-sm font-medium transition-colors">
                Eliminar
              </button>
            </div>
          </div>

          <div class="bg-gray-50 border-t border-gray-200 px-6 py-3">
            <h4 class="text-sm font-semibold text-indigo-700 mb-2">Detalles del Pedido:</h4>

            <ul class="list-disc ml-6 space-y-1 text-sm text-gray-700">
              @for (item of order.items; track $index) {
              <li>
                Producto ID: <strong>{{ item.productId }}</strong> ‚Äî Cant: {{ item.quantity }} √ó
                <strong>{{ item.priceAtOrder | currency }}</strong>
              </li>
              } @empty {
              <li class="text-gray-500 italic">No hay √≠tems asociados a esta orden.</li>
              }
            </ul>
          </div>
        </div>
        } @empty {
        <div
          class="p-6 text-center text-gray-500 bg-gray-50 rounded-xl border border-dashed border-gray-300"
        >
          No se encontraron √≥rdenes.
        </div>
        }
      </div>
    </section>
    }
  </div>
</div>
